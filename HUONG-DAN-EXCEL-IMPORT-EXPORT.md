# HÆ°á»›ng dáº«n Import/Export Excel

## ğŸ“‹ Tá»•ng quan

Há»‡ thá»‘ng há»— trá»£ import/export dá»¯ liá»‡u qua file Excel vá»›i tÃ­nh nÄƒng **preview vÃ  chá»n hÃ ng/cá»™t** trÆ°á»›c khi thá»±c hiá»‡n.

---

## ğŸš€ TÃ­nh nÄƒng chÃ­nh

### âœ… Import Excel
- **Upload file**: Chá»n file .xlsx hoáº·c .xls
- **Preview table**: Xem trÆ°á»›c toÃ n bá»™ dá»¯ liá»‡u
- **Chá»n hÃ ng**: Checkbox Ä‘á»ƒ chá»n hÃ ng nÃ o cáº§n import
- **Chá»n cá»™t**: Checkbox Ä‘á»ƒ chá»n cá»™t nÃ o cáº§n import
- **Search**: TÃ¬m kiáº¿m trong dá»¯ liá»‡u
- **Pagination**: PhÃ¢n trang náº¿u dá»¯ liá»‡u nhiá»u
- **Validation**: Kiá»ƒm tra dá»¯ liá»‡u trÆ°á»›c khi import

### âœ… Export Excel
- **Chá»n cá»™t export**: Checkbox chá»n cá»™t
- **Äáº·t tÃªn file**: TÃ¹y chá»‰nh tÃªn file output
- **Preview**: Xem trÆ°á»›c 5 hÃ ng Ä‘áº§u
- **Auto-size columns**: Tá»± Ä‘á»™ng Ä‘iá»u chá»‰nh Ä‘á»™ rá»™ng cá»™t
- **Download**: Táº£i file .xlsx

---

## ğŸ“ Template Excel

### Tasks Template (CÃ´ng viá»‡c)

| TiÃªu Ä‘á» | MÃ´ táº£ | Dá»± Ã¡n | NgÆ°á»i thá»±c hiá»‡n | Äá»™ Æ°u tiÃªn | NgÃ y báº¯t Ä‘áº§u | NgÃ y háº¿t háº¡n | Tráº¡ng thÃ¡i |
|---------|-------|-------|-----------------|------------|--------------|--------------|------------|
| Thiáº¿t káº¿ giao diá»‡n | Thiáº¿t káº¿ UI/UX cho trang chá»§ | Dá»± Ã¡n A | Nguyá»…n VÄƒn A | cao | 2025-01-01 | 2025-01-15 | má»›i |
| PhÃ¡t triá»ƒn API | XÃ¢y dá»±ng REST API | Dá»± Ã¡n A | Tráº§n Thá»‹ B | cao | 2025-01-05 | 2025-01-20 | Ä‘ang lÃ m |

**LÆ°u Ã½:**
- `Äá»™ Æ°u tiÃªn`: tháº¥p, trung bÃ¬nh, cao, kháº©n cáº¥p
- `Tráº¡ng thÃ¡i`: má»›i, Ä‘ang lÃ m, Ä‘ang kiá»ƒm tra, hoÃ n thÃ nh, bá»‹ trÃ¬ hoÃ£n, quÃ¡ háº¡n
- `NgÃ y`: Äá»‹nh dáº¡ng YYYY-MM-DD hoáº·c DD/MM/YYYY

### Projects Template (Dá»± Ã¡n)

| MÃ£ dá»± Ã¡n | TÃªn dá»± Ã¡n | MÃ´ táº£ | KhÃ¡ch hÃ ng | NgÃ y báº¯t Ä‘áº§u | NgÃ y káº¿t thÃºc | Tráº¡ng thÃ¡i | NgÃ¢n sÃ¡ch |
|----------|-----------|-------|------------|--------------|---------------|------------|-----------|
| DA-001 | Website bÃ¡n hÃ ng | XÃ¢y dá»±ng website thÆ°Æ¡ng máº¡i Ä‘iá»‡n tá»­ | CÃ´ng ty ABC | 2025-01-01 | 2025-06-30 | Ä‘ang tiáº¿n hÃ nh | 500000000 |
| DA-002 | App di Ä‘á»™ng | á»¨ng dá»¥ng quáº£n lÃ½ bÃ¡n hÃ ng | CÃ´ng ty XYZ | 2025-02-01 | 2025-08-31 | Ä‘ang lÃªn káº¿ hoáº¡ch | 800000000 |

**LÆ°u Ã½:**
- `MÃ£ dá»± Ã¡n`: Duy nháº¥t, khÃ´ng trÃ¹ng
- `Tráº¡ng thÃ¡i`: Ä‘ang lÃªn káº¿ hoáº¡ch, Ä‘ang tiáº¿n hÃ nh, táº¡m dá»«ng, hoÃ n thÃ nh, há»§y bá»
- `NgÃ¢n sÃ¡ch`: Sá»‘ tiá»n (VNÄ)

### Staff Template (NhÃ¢n sá»±)

| Há» tÃªn | Email | Sá»‘ Ä‘iá»‡n thoáº¡i | NgÃ y sinh | NgÃ y vÃ o lÃ m | Vai trÃ² | Tráº¡ng thÃ¡i |
|--------|-------|---------------|-----------|--------------|---------|------------|
| Nguyá»…n VÄƒn A | nguyenvana@email.com | 0901234567 | 1990-01-15 | 2020-03-01 | user | Hoáº¡t Ä‘á»™ng |
| Tráº§n Thá»‹ B | tranthib@email.com | 0907654321 | 1992-05-20 | 2021-06-15 | admin | Hoáº¡t Ä‘á»™ng |

**LÆ°u Ã½:**
- `Email`: Äá»‹nh dáº¡ng email há»£p lá»‡, duy nháº¥t
- `Vai trÃ²`: user, admin, manager
- `Tráº¡ng thÃ¡i`: Hoáº¡t Ä‘á»™ng, VÃ´ hiá»‡u

---

## ğŸ¯ HÆ°á»›ng dáº«n sá»­ dá»¥ng

### Import dá»¯ liá»‡u

1. **Chuáº©n bá»‹ file Excel**
   - Download template tá»« há»‡ thá»‘ng
   - Äiá»n Ä‘áº§y Ä‘á»§ dá»¯ liá»‡u theo format
   - LÆ°u file .xlsx

2. **Upload file**
   - Click nÃºt **"Import Excel"**
   - Chá»n file tá»« mÃ¡y tÃ­nh
   - Äá»£i há»‡ thá»‘ng Ä‘á»c file

3. **Preview vÃ  chá»n dá»¯ liá»‡u**
   - Xem toÃ n bá»™ dá»¯ liá»‡u trong báº£ng
   - **Chá»n cá»™t**: Click checkbox á»Ÿ header cá»™t
   - **Chá»n hÃ ng**: Click checkbox á»Ÿ Ä‘áº§u hÃ ng
   - **Chá»n táº¥t cáº£**: Click nÃºt "Chá»n táº¥t cáº£ hÃ ng" hoáº·c "Chá»n táº¥t cáº£ cá»™t"
   - **TÃ¬m kiáº¿m**: GÃµ tá»« khÃ³a vÃ o Ã´ search

4. **XÃ¡c nháº­n import**
   - Kiá»ƒm tra sá»‘ hÃ ng/cá»™t Ä‘Ã£ chá»n
   - Click **"XÃ¡c nháº­n import"**
   - Chá» há»‡ thá»‘ng xá»­ lÃ½

5. **Káº¿t quáº£**
   - ThÃ´ng bÃ¡o thÃ nh cÃ´ng/tháº¥t báº¡i
   - Danh sÃ¡ch lá»—i (náº¿u cÃ³)
   - Dá»¯ liá»‡u Ä‘Æ°á»£c thÃªm vÃ o há»‡ thá»‘ng

### Export dá»¯ liá»‡u

1. **Má»Ÿ modal export**
   - Click nÃºt **"Export Excel"**
   - Modal preview hiá»ƒn thá»‹

2. **Chá»n cá»™t cáº§n export**
   - Click checkbox cÃ¡c cá»™t muá»‘n xuáº¥t
   - Hoáº·c click "Chá»n táº¥t cáº£"

3. **Äáº·t tÃªn file**
   - Nháº­p tÃªn file (khÃ´ng cÃ³ Ä‘uÃ´i .xlsx)
   - Máº·c Ä‘á»‹nh: export, tasks, projects, staff...

4. **Preview (tÃ¹y chá»n)**
   - Click "Hiá»‡n preview"
   - Xem 5 hÃ ng Ä‘áº§u tiÃªn

5. **Export**
   - Click **"Export Excel"**
   - File sáº½ tá»± Ä‘á»™ng download

---

## âš™ï¸ TÃ­nh nÄƒng nÃ¢ng cao

### Validation tá»± Ä‘á»™ng

Khi import, há»‡ thá»‘ng tá»± Ä‘á»™ng kiá»ƒm tra:
- âœ… Email Ä‘Ãºng Ä‘á»‹nh dáº¡ng
- âœ… Sá»‘ Ä‘iá»‡n thoáº¡i há»£p lá»‡
- âœ… NgÃ y thÃ¡ng Ä‘Ãºng format
- âœ… TrÆ°á»ng báº¯t buá»™c khÃ´ng Ä‘á»ƒ trá»‘ng
- âœ… GiÃ¡ trá»‹ trong danh sÃ¡ch cho phÃ©p
- âœ… Äá»™ dÃ i kÃ½ tá»±

### Column mapping

Há»‡ thá»‘ng tá»± Ä‘á»™ng map cá»™t Excel vá»›i field database:
- TiÃªu Ä‘á» â†’ title
- MÃ´ táº£ â†’ description
- Dá»± Ã¡n â†’ project_id (tá»± Ä‘á»™ng tÃ¬m project)
- NgÆ°á»i thá»±c hiá»‡n â†’ assigned_to (tá»± Ä‘á»™ng tÃ¬m user)
- NgÃ y báº¯t Ä‘áº§u â†’ start_date
- NgÃ y háº¿t háº¡n â†’ due_date

### Error handling

Náº¿u cÃ³ lá»—i khi import:
- Hiá»ƒn thá»‹ danh sÃ¡ch lá»—i chi tiáº¿t
- Vá»‹ trÃ­ hÃ ng bá»‹ lá»—i
- Loáº¡i lá»—i
- GiÃ¡ trá»‹ khÃ´ng há»£p lá»‡
- HÆ°á»›ng dáº«n sá»­a lá»—i

---

## ğŸ’¡ Tips & Tricks

### Import
- âœ… **Chuáº©n bá»‹ data**: LÃ m sáº¡ch dá»¯ liá»‡u Excel trÆ°á»›c khi import
- âœ… **Kiá»ƒm tra format**: Äáº£m báº£o ngÃ y thÃ¡ng Ä‘Ãºng Ä‘á»‹nh dáº¡ng
- âœ… **Test nhá»**: Import vÃ i hÃ ng test trÆ°á»›c khi import hÃ ng loáº¡t
- âœ… **Backup**: Backup dá»¯ liá»‡u trÆ°á»›c khi import Ä‘á»ƒ trÃ¡nh máº¥t data
- âœ… **Chá»n cá»™t cáº§n thiáº¿t**: KhÃ´ng nháº¥t thiáº¿t pháº£i import háº¿t cÃ¡c cá»™t

### Export
- âœ… **Chá»n cá»™t**: Chá»‰ export nhá»¯ng cá»™t cáº§n thiáº¿t Ä‘á»ƒ file nháº¹
- âœ… **Preview**: LuÃ´n preview trÆ°á»›c khi export
- âœ… **Äáº·t tÃªn rÃµ rÃ ng**: tasks_2025-01-15.xlsx
- âœ… **Export thÆ°á»ng xuyÃªn**: Backup Ä‘á»‹nh ká»³

---

## ğŸ› Troubleshooting

### Lá»—i "KhÃ´ng thá»ƒ Ä‘á»c file"
â†’ Äáº£m báº£o file lÃ  .xlsx hoáº·c .xls (khÃ´ng pháº£i .csv)

### Lá»—i "File khÃ´ng cÃ³ dá»¯ liá»‡u"
â†’ Kiá»ƒm tra Sheet Ä‘áº§u tiÃªn cÃ³ dá»¯ liá»‡u khÃ´ng

### Lá»—i validation
â†’ Xem chi tiáº¿t lá»—i trong danh sÃ¡ch errors, sá»­a data vÃ  thá»­ láº¡i

### Import cháº­m
â†’ File quÃ¡ lá»›n, chia nhá» thÃ nh nhiá»u file < 1000 hÃ ng

### Export thiáº¿u cá»™t
â†’ Kiá»ƒm tra Ä‘Ã£ chá»n Ä‘á»§ cÃ¡c cá»™t chÆ°a trong modal

---

## ğŸ“Š Giá»›i háº¡n

- **File size**: Tá»‘i Ä‘a 10MB
- **Sá»‘ hÃ ng**: Khuyáº¿n nghá»‹ < 5000 hÃ ng/láº§n import
- **Format**: Chá»‰ há»— trá»£ .xlsx vÃ  .xls
- **Sheets**: Chá»‰ Ä‘á»c sheet Ä‘áº§u tiÃªn

---

## ğŸ”§ Technical

### Libraries
- **xlsx** (SheetJS): Xá»­ lÃ½ file Excel
- **React**: UI components
- **Tailwind CSS**: Styling

### API
```javascript
// Import
import ExcelService from '../utils/excelService'
const result = await ExcelService.readExcelFile(file)

// Export
ExcelService.exportToExcel(data, fileName, options)
```

### Components
- `ExcelImportButton`: NÃºt import vá»›i preview
- `ExcelExportButton`: NÃºt export vá»›i chá»n cá»™t
- `ExcelPreviewModal`: Modal preview data
- `ExcelExportModal`: Modal chá»n cá»™t export
- `ExcelService`: Service xá»­ lÃ½ Excel

---

## ğŸ“ Support

Náº¿u gáº·p váº¥n Ä‘á»:
1. Äá»c láº¡i hÆ°á»›ng dáº«n nÃ y
2. Kiá»ƒm tra format Excel template
3. Xem console log Ä‘á»ƒ debug
4. LiÃªn há»‡ admin há»‡ thá»‘ng

---

**Cáº­p nháº­t:** October 2025  
**Version:** 1.0.0
